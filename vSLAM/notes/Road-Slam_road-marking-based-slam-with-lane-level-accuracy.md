# Road-SLAM : Road Marking based SLAM with Lane-level Accuracy

## 摘要
这篇文章提出了一个通过摄像头获取图像,并根据获取的图像检测闭环,从而提高SLAM精度的方法. 在这篇文章中,采用路标识别的方式进行回环检测,但是由于路标很多,而且有的位置很近, 直接使用路标进行闭环检测,会存在一个视觉对齐引起的.为了能使用后路标信息准确的进行回环检测, 这篇文章提出了一个构建sub-map的方法, 在其构建sub-map的方法中使用了随机森林进行路标分类,并且只选择具有明显可分离性的特征,而且还设计了路标特征向量.

## 简介

高精度的地图定位一直是一个难题,也是一个有意思的研究方向,很多研究者使用不同的传感器,来获取高精度的定位,比如GPS,但是GPS只能获取米级别的精度,对于车道线级别的精度还不能达到,而且,在城镇区域,GPS还会遇到更多的问题;另外,车载的传感器,比如轮编码器和IMU,精度相对于GPS更高一些,但是只能进行局部定位,而且存在误差累积. 为了获取高精度的定位,很多研究者开始使用SLAM,因为SLAM可以使用更多的传感器信息,比如可以使用摄像机获取图像信息,还有使用3D激光雷达(成本太高).最后,本文提出的方法是基于普通的板载摄像头,从摄像头的获取的图像中,检测路标,边缘线等信息,然后提取这些目标的特征,进行Lane-Level的定位.但是这里存在的问题:很多路标和路线有相似的形状和重复的模式,这在进行定位的时候会产生高度的不确定性.

这篇文章就是来解决上面的问题,使用随机森林训练,只把可分离的路标进行分类,通过分类能够避免模糊匹配,接下来根据分类的路标信息构建sub-map,然后匹配sub-map进行回环检测,这种场景再识别的方法只使用了视觉路标,这种方法对于环境变化(比如光照,时间,周围环境变化)不敏感.

整个SLAM的过程如下:

- 使用信息特征选择进行鲁棒性的匹配
- 完全自动化的匹配检测
- 从视觉回环检测进行精确的定位(厘米级)

## 总览

这篇文章的重点是如何利用路标信息进行回环检测,IMU和里程计都不是重点.

在论文中,他们也提到了算法的测试平台,如下面图描述;
![]()
- 一个前向的ZED摄像头
- 一个IMU
- 两个轮式编码器

这里面,IMU和轮式编码器是在车内的传感器,用来进行过导航.
摄像头获取的图像用来检测路标和路线,RTK-GPS是用来完成车辆位姿和方向的初始化,以及作为GroundTruth使用.
ZED摄像头可以获取图像的深度信息,但是这里只用了图像信息,获取图像的频率是10Hz.

这篇文章整体的算法结构如下图所示:
![]()

第一步:根据获取的图像,产生点云数据,并且去除去除相机角度的影响,这些是由IPM模块完成.
第二步:将点云数据进行自适应二值化,为了方便从中提取路标
第三步:使用分割算法,把点云数据分割成若干部分,这些元素组成一个sub-map,然后对sub-map使用随机森林进行分类,这篇文章是分成了6类,在这一步中,为了提高匹配的准确性, 只有那些降低模糊分类的sub-map被最终选择最终sub-map;
最后,sub-map在进行匹配,检测回环.

## 使用sub-map进行回环检测

这里分为以下几个步骤:预处理,使用IPM进行分割,然后对sub-map进行分类,sub-map产生模块经过仔细的筛选,选择出sub-map,然后进行sub-map匹配.

### A 产生点云

这里是预处理和二值化,图像首先经过IPM算法进行处理,产生鸟瞰图像,目的是去除视角的影响,传统的IPM假设太多,这里使用的是一种改进的IPM算法,提高IPM算法的稳定性.然后对IPM处理后的结果进行二值化处理.

接下来,将这个二值图像进行处理,生成点云数据(根据导航的轨迹,IMU和编码器组成),具体没有介绍如何生成点云.

所谓的sub-map就是map,由在车的坐标系下的3D点路标组成.这些sub-map是在车辆的行驶过程中,根据检测到路上的路标和路线产生的.

### B 路标分割

在点云产生前,产生的二值图像,还要对其进行分割.原因有两个:
第一,并不是所有的路标都是对姿态估计是有意义的,比如与车辆行驶同方向的中间线,在车辆行驶方向不能预测移动信息,还有交叉路口的信息有很多冗余信息.在图像分割阶段就是要去除这些无用路标,实际上,只选择虚线,箭头,路标,以及数字等包含信息的匹配.

第二,在很多场景中,多个路标在一个图像中,而且经常非常近,分割的目的就是方便对路标进行聚类.

整个分割过程是端到端的,首先要做一个体素化的一个滤波处理,去除一定的噪声,然后分割分为两个阶段,第一阶段,用较小的半径,将打的特征分割成单个部分,虚线分割成若干部分,这个初始分割是为了将线分割出来;接下来的分割用一个较大的半径,把数字和人行道分个出来.

### C 分类

前面已经进行了分割,后面需要进行分类,进一步降低IPM对匹配的影响.
这里使用ESF特征,分类方法是使用的随机森林,最大深度是100,最终分为了6类:路标,数字,箭头,线,人行道和其他.

### D 基于GICP的sub-map匹配

当再次到达同一个地方,进行sub-map匹配,首先是根据位置阈值选择出一些候选的sub-map,然后根据ICP算法选择出代价函数最小,如果匹配成功,两个sub-map的相对距离就能用ICP计算出来,然后传递给iSAM进行姿态图估计.


### E Road-SLAM
整个算法是基于损失函数的优化过程,其损失函数定义如下所示


## 总结
用路标分类和匹配的方法,提高了定位的精度,但是还是存在问题,比如阴影在一些场景会影响很大.