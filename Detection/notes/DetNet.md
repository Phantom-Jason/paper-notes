# DetNet 一个专门为目标检测设计的主干网络

## 摘要
首先介绍之前的目标检测，分为两种：一步法和两步法，一步法包含之前的YOLO系列和SSD，还有现在的RetinaNet；两步法包含现在的Faster RCNN系列，以及FPN系列。这些算法都是在ImageNet分类网络的基础上进行Finetune，但是从来没有解释为什么用分类的网络作为基干网络。这篇文章认为分类的网络与目标检测的任务需求有着本质的不同。
1. 比如RetinaNet网络在基干网络上添加了很多额外的处理，用来解决尺度变化的问题，在分类网络中，没有尺度变化的问题
2. 分类的网络用了很多的降采样，这些降采样用来抽象化图像的特征，但是降低了分辨率，对于目标检测的空间定位问题是不利的。
这篇文章采用DetNet网络，专门设计一个用于目标检测的网络，用解决上面提到的两个问题。

## 简介
介绍了卷积神经网络在特征提取的优势，相对于传统的手工设计的特征，卷积神经网络在图像分类任务中成果显著；接着介绍了基于RCNN的神经网络在目标检测的应用，然后引出了用分类网络作为主干网络的目标检测方法存在的问题：1.  不能适应尺度的变化；2. 降采样对目标定位不利。
一个好的目标检测算法应该解决这两个问题。
比如，像FPN一样，增加额外的stage，用来解决尺度变化的问题，不降采样，维持分辨率不变，但是会存在增加计算复杂度的问题。

## 相关工作

之前的基于手动设计特征的方式，以及之前的基于RCNN的方式。其中基于RCNN的方式大部分都是在分类基干网络上做的FineTune。

1. 分类网络基干
ImageNet数据库是分类网络的权威数据库，用来训练和测试网络，常用的分类基干网络包括AlexNet， VGG， GoogleNet，ResNet，Xception，DenseNet，DRN等

2. 目标检测的分支

YOLO和SSD是直接在基干网络上添加的额外的几层，YOLO是基于Google Net，SSD是用了减除后的VGG-16，RetinaNet是在ResNet上添加额外的层，改动最大的是目标函数，YOLO简化为回归问题，目标函数是一个类似与最小二乘的东西，用的是二范数，SSD分类使用的Softmax 回归，定位是用的二范数回归。

Faster RCNN是直接在基干网络上用RPN产生一些候选，然后对候选进行分类，FPN是引用了金字塔的方式解决了多尺度的问题。

作者认为，分类与检测还是由本质的区别，两种网络结构不能完美的匹配，用于检测的基干网络目前是没有探索，这篇文章的关键之处设计一种针对检测的基干网络。

## DetNet

1. 动机
相对于分类问题，在目标识别问题中，不仅需要识别类别，还需要定位。传统的分类问题是不停的降采样，降低特征图的分辨率，但是损失的特征图的分辨率对于定位和尺度都是不利的，虽然RPN通过特征金姿态的方式能够解决分辨率的问题，但是仍然要存在下面三个问题：

- 网络stage数量不同，需要增加额外的stage
- 对于大的目标定位能力较弱，在分类网络中，经过多个阶段，每个阶段都会降采样，最后的特征图一个cell对应一个很大的感受野，有利于分类，不利于定位，在使用特征金字塔网络时，用越深层产生特征来你和物体的位置，误差越大。
- 对小物体的回调率比较低，随着降采样，小目标在特征图中的信息会逐渐弱化，FPN用shadow层检测，然后用纹理信息增强分类器，但是随着深度的增加，纹理的信息也会随着减弱。

DetNet的好处是设计一个针对目标检测的网络结构，可以不需要添加更多的额外的网络层，另外，即使要添加更多网络层，特征图的分辨率还是很高。

2. DetNet设计
作者使用ResNet-50作为基线。
设计一个专门用于目标检测算法的基干网络，存在两个挑战：
1. 保持特征图的空间分辨率
2. 如果特征图的分辨率高，那么对应的感受野就小，不利于图像分类和分割等图像处理任务

DetNet-59是基于ResNet-50，保持了ResNet中的第一到第四stage，然后添加了第五和stage，详细的结构如下图所示

![]()

1. 在基干网络中，引入了额外的结构，比如在FPN中使用的网络结构
2. 前4个stage都是ResNet中的，每一个stage降采样，到了第五stage，降采样16倍了，以后就保持这个分辨率，为此，引入了改进后的膨胀瓶颈结构，如上图中的B。
3. 在网络中应用膨胀瓶颈结构，保持了特征图的分辨率，但是计算复杂度增加了，为了降低计算复杂度，在第5和6结构中，通道数不增加，一定程度上降低了计算复杂度。


## 实验
用的是MSCOCO数据集进行测试，其中包含80k的训练数据集和40k的测试数据集，作者把40k的训练数据集分割成两部分，一部分是35k，另一部分是5k，作者用80k的训练数据集和35k的测试数据集训练，然后用5k的数据集进行验证，最后在coco 的test-dev数据集测试，这个测试数据集没有公开的标签，验证程序完全按照COCO提供的。